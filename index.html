<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Python Notes Repository</title>
<style>
  body { margin:0; font-family:Arial, sans-serif; }
  header {
    background:#2d6cdf; color:white; padding:10px 15px;
    font-size:1rem; font-weight:bold; text-align:center;
    position:sticky; top:0; z-index:1000;
    display:flex; justify-content:space-between; align-items:center;
  }
  header button {
    background:none; border:none; color:white; font-size:1.2em; cursor:pointer;
    display:none; /* shown only on mobile */
  }
  .layout { display:flex; height:calc(100vh - 48px); }

  /* Sidebar */
  .sidebar {
    width:280px; background:#f5f7fa; border-right:1px solid #ccc;
    overflow-y:auto; padding:10px;
    transition:transform 0.3s ease;
  }
  .sidebar h2 { font-size:1em; margin:10px 0; cursor:pointer; color:#2d6cdf; }
  .sidebar ul { list-style:none; padding-left:15px; display:none; }
  .sidebar li { margin:5px 0; }
  .sidebar a { color:#1a4bb7; text-decoration:none; font-size:0.85em; }
  .sidebar a:hover { text-decoration:underline; color:#d35400; }
  .sidebar b { cursor:pointer; color:#2d6cdf; font-size:0.85em; display:block; margin:4px 0; }

  /* Content */
  .content { flex:1; padding:0; overflow:hidden; position:relative; }
  .viewer { width:100%; height:100%; border:none; }
  #downloadBtn {
    display:none; position:absolute; top:10px; right:10px;
    background:#2d6cdf; color:white; border:none; padding:6px 10px;
    border-radius:5px; cursor:pointer;
  }
  #downloadBtn:hover { background:#ff5733; }

  /* Responsive adjustments */
  @media(max-width:900px) {
    .sidebar {
      position:fixed; top:48px; left:0; bottom:0;
      transform:translateX(-100%); z-index:2000;
      box-shadow:2px 0 8px rgba(0,0,0,0.2);
    }
    .sidebar.active { transform:translateX(0); }
    header button { display:inline-block; }
    .layout { flex-direction:column; }
    .content { flex:1; margin-left:0; }
  }
</style>
</head>
<body>

<!-- Header -->
<header>
  <span>ðŸ“˜ Python Notes Repository</span>
  <button id="menuToggle">â˜°</button>
</header>

<div class="layout">
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <h2 data-toggle="syllabus">Syllabus</h2>
    <ul id="syllabus"></ul>
    <h2 data-toggle="notes">Notes</h2>
    <ul id="notes"></ul>
    <h2 data-toggle="programs">Programs</h2>
    <ul id="programs"></ul>
    <h2 data-toggle="assignments">Assignments</h2>
    <ul id="assignments"></ul>
    <h2 data-toggle="ebooks">Ebooks</h2>
    <ul id="ebooks"></ul>
    <h2 data-toggle="exampapers">ExamPapers</h2>
    <ul id="exampapers"></ul>
  </div>

  <!-- Content Viewer -->
  <div class="content">
    <button id="downloadBtn">â¬‡ Download</button>
    <iframe id="viewer" class="viewer"></iframe>
  </div>
</div>

<script>
const rawBase ="";
//const rawBase = "https://raw.githubusercontent.com/naveenupreti/Python-Notes/main/";
const sidebar = document.getElementById("sidebar");
const menuToggle = document.getElementById("menuToggle");
const downloadBtn = document.getElementById("downloadBtn");
const viewer = document.getElementById("viewer");

// Sidebar toggle on mobile
menuToggle.addEventListener("click", () => {
  sidebar.classList.toggle("active");
});

// Load JSON data
async function loadData() {
  const res = await fetch(rawBase + "data.json?ts=" + Date.now());
  const data = await res.json();
  buildSidebar("syllabus", data.syllabus);
  buildSidebarGrouped("notes", data.notes);
  buildSidebarGrouped("programs", data.programs);
  buildSidebar("assignments", data.assignments);
  buildSidebar("ebooks", data.ebooks);
  buildSidebar("exampapers", data.exampapers);
}

// Build sidebar for simple lists
function buildSidebar(containerId, items) {
  const ul = document.getElementById(containerId);
  ul.innerHTML = "";
  if (!items) return;
  items.forEach(f => {
    const fileObj = typeof f === "string" ? { path:f } : f;
    if (!fileObj) return;
    const li = document.createElement("li");
    const link = document.createElement("a");
    link.textContent = fileObj.title || fileObj.path.split("/").pop();
    link.href = "#";
    link.onclick = () => openFile(fileObj.path);
    li.appendChild(link);
    ul.appendChild(li);
  });
}

// Build sidebar for grouped units (Notes, Programs)
function buildSidebarGrouped(containerId, units) {
  const ul = document.getElementById(containerId);
  ul.innerHTML = "";
  if (!units) return;
  Object.entries(units).forEach(([unit, files]) => {
    const li = document.createElement("li");
    const b = document.createElement("b");
    b.textContent = unit;
    const sub = document.createElement("ul");
    sub.style.display = "none";
    files.forEach(f => {
      const fileObj = typeof f === "string" ? { path:f } : f;
      if (!fileObj) return;
      const link = document.createElement("a");
      link.textContent = fileObj.title || fileObj.path.split("/").pop();
      link.href = "#";
      link.onclick = () => openFile(fileObj.path);
      const subLi = document.createElement("li");
      subLi.appendChild(link);
      sub.appendChild(subLi);
    });
    b.onclick = () => sub.style.display = sub.style.display === "none" ? "block" : "none";
    li.appendChild(b);
    li.appendChild(sub);
    ul.appendChild(li);
  });
}

// Open file in right viewer
function openFile(path) {
  const url = rawBase + path;
  if (path.endsWith(".pdf")) {
    viewer.src = "https://docs.google.com/viewer?url=" + encodeURIComponent(url) + "&embedded=true";
  } else if (path.endsWith(".py") || path.endsWith(".txt")) {
    viewer.src = url;
  } else {
    viewer.src = url;
  }
  downloadBtn.style.display = "inline-block";
  downloadBtn.onclick = () => window.open(url, "_blank");

  // Close sidebar on mobile after selecting file
  if (window.innerWidth <= 900) {
    sidebar.classList.remove("active");
  }
}

// Collapse/expand toggle for main sections
document.querySelectorAll(".sidebar h2").forEach(h => {
  h.addEventListener("click", () => {
    const ul = document.getElementById(h.dataset.toggle);
    ul.style.display = ul.style.display === "block" ? "none" : "block";
  });
});

loadData();
</script>
</body>
</html>
